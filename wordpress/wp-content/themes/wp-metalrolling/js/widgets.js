function findPos(e){var t={x:0,y:0};if(e.offsetParent)for(;e.offsetParent;)t.y+=e.offsetTop,t.x+=e.offsetLeft,e=e.offsetParent;else e.x&&(t.x+=e.x),e.y&&(t.y+=e.y);return t}var widgets={preloaderURL:"/shared/images/preloader.gif",addToCart:function(e,t,o,n){var r=1;return t=Number(t),o=Number(o),$.post("/my/s3/export/shop/product.php",{mode:"json",action:"get-product",shop_id:e,product_id:t},function(i){if(widgets.isEmptyObject(i)&&"string"==typeof n.href)return location.href=n.href,!0;i&&void 0!=i.product_price&&(o=Number(i.product_price));var a=!0,d=r,s="1"==i.product_amount_limit;if(s&&(d=Number(i.product_amount),d<r&&(r=d)),!isNaN(e)&&e>0&&!isNaN(t)&&t>0&&!isNaN(o)&&!isNaN(r)&&r>0){var f,c,l,u="",p=!1,h=0,m=readCookie("CART_TOTAL_"+e),g=unescape(readCookie("CART_"+e)),y=g.split(";");isNaN(m)&&(m=Number(m));for(var w=0;w<y.length;w++)f=y[w].split("="),2==f.length&&(p||f[0]!=t?(""!=u&&(u+=";"),u=u+f[0]+"="+f[1],h+=Number(f[1])):(s&&f[1]>=d||(m=Number(m)+o*r),c=r+Number(f[1]),s&&c>d&&(c=d,a=!1,widgets.msg(window._s3Lang.JS_SHOP_PRODUCT_AMOUNT_TOTAL+": "+d,n)),p=!0,""!=u&&(u+=";"),u=u+t+"="+c,h+=c));return p||(""!=u&&(u+=";"),u=u+t+"="+r,m=Number(m)+o*r,h+=r),m=Math.round(100*m)/100,createCookie("CART_"+e,u,10),createCookie("CART_TOTAL_"+e,m,10),createCookie("CART_TOTAL_AMOUNT_"+e,h,10),l=document.getElementById("cart_total"),l&&(l.innerHTML=m),l=document.getElementById("cart_total_amount"),l&&(l.innerHTML=h),a&&widgets.msg(window._s3Lang.JS_ADDED,n),!0}},"json"),!1},formatPrice:function(e,t,o){"string"!=typeof e&&(e=String(e)),null==t&&(t=" "),null==o&&(o="."),"."!=o&&(e=e.replace(".",o));var n,r=e.split(o),i=[];if(r[0].length>=4){for(n=r[0].length-1,j=1;n>=0;--n,++j)i.unshift(r[0].charAt(n)),j%3==0&&n>0&&i.unshift(t);return i.join("")+(r[1]?o+r[1]:"")}return e},addOnloadEvent:function(e){var t=window.onload;"function"!=typeof window.onload?window.onload=e:window.onload=function(){t&&t(),e()}},msg:function(e,t,o){if(t){var n=findPos(t),r=document.createElement("DIV");if(r){r.style.position="absolute",r.innerHTML=e,r.style.display="block",r.className=o?o:"added-to-cart",r.style.left=n.x+t.offsetWidth+"px",r.style.top=n.y+t.offsetHeight+"px";try{$(window).width()<=parseInt(r.style.left)+120&&(r.style.left=n.x-80+"px",r.style.top=n.y+t.offsetHeight+"px")}catch(i){}document.body.appendChild(r),window.setTimeout(function(){r&&r.parentNode&&r.parentNode.removeChild(r),delete r},1500)}}},createPreloader:function(node){var pos=findPos(node),div=document.createElement("div");with(div.style)position="absolute",display="block",left=pos.x+node.offsetWidth+"px",top=pos.y+node.offsetHeight+"px",width=32,height=32,background="url("+this.preloaderURL+") center center no-repeat transparent",zIndex=2e3;return div},addEvent:function(e,t,o){e.addEventListener?e.addEventListener(t,o,!1):e.attachEvent&&e.attachEvent("on"+t,o)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0}};String.prototype.trim=function(e){var t=e?e:"[\\t\\s\\n\\r]";return this.replace(new RegExp("^"+t+"+"),"").replace(new RegExp(t+"+$"),"")},widgets.addEvent(window.document,"keydown",function(e){e.altKey&&80==e.keyCode&&location.search.indexOf("profiling")==-1&&(location.search.indexOf("?")==-1?location.search+="?profiling="+Math.round(1e5*Math.random()):location.search+="&profiling="+Math.round(1e5*Math.random()))});
//# sourceMappingURL=maps/widgets.js.map
